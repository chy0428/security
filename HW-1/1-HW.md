# GBC Security_01

## INFO
* 이름 | 최하영
* 나이 | 21
* 학번 | 21800758
* 전공 | 컴퓨터공학심화

## HW #1

### 1. CVE
---
* CVE란? 
 - Commonm Vulnerabilities and Exposure의 약자로, 보안 취약점을 가리킨다.
 - CVE를 사용하기 이전에는 각 기관이나 업체마다 각자의 보안취약점을 가리키는 이름을 붙여 사용했다. 이는 일관성이 없고 비효율적이였기 때문에, CVE를 사용하게 됐다.
 - CVE는 프로그램의 보안 취약점을 가르키는 고유의 표기로, **CVE + 취약점 발견 연도 + 취약점 고유번호**로 표기한다.
 - ex) CVE-2019-2727 : 2019년에 발견된 2727번 취약점
 
 
1. 카카오톡 PC 메신저 원격 코드 실행 취약점
 * 개요 
  	 * 취약점 : CVE-2019-9132
 	 * 카카오톡 윈도우 PC 메신저에서 발생하는 원격 코드 실행 취약점
  	 * 취약점 종류 : 원격 코드 실행
 * 설명
  	 * 카카오톡 윈도우 PC 메신저에서 메세지에 포하된 특수하게 제작된 링크를 사용자가 클릭할 경우, 임의 코드 실행으로 이어지는 취약점
 * 영향을 받는 제품
  	 * 카카오톡 윈도우 PC 메신저
 	 * 2.7.5.2024 이하 version
 * 해결 방안 
  	 * 취약한 버전의 제품 이용자는 카카오톡 윈도우 버전 2.7.6 이상으로 설치

2. WordPress RCE 취약점
 * 개요
 	 * CVE-2019-8942 | 이미지 업데이트 시 postmeta 값에 대한 검증이 부족하여 이미지 업로드를 통해 원격으로 코드를 실행할 수 있는 취약점
 	 * CVE-2019-8943 | 파일 저장 경로를 조작할 수 있는 불필요한 파라미터가 존재하여, CVE-2019-8942 취약점과 함께 사용할 경우 임의의 경로에 이미지를 저장할 수 있는 취약점
 	 * CVE-2019-9787 | 댓글 작성 시 a태그의 rel 속성 처리가 미흡하여 공격자가 CSRF를 통해 원격으로 코드를 실행 할 수 있는 취약점
 * 영향을 받는 소프트웨어 버전
  	 * WordPress | 4.9.9, 5.0.1 이전 버전 (CVE-2019-8942/8943), 5.1.1 이전 버전 (CVE-2019-9787)
 * 취약점 설명
  	 * CVE-2019-8942 | postmeta 테이블의 _wp_attached_file값을 sample.jpg#shell.jpg와 같은 임의의 문자열로 변경할 수 있다. 이 취약점을 이용하여 공격자는 Exif meta 데이터에 PHP 코드가 포함된 이미지를 업로드하여 임의의 코드를 실행할 수 있다.
  	 * CVE-2019-8943 | wp_crop_image() 함수에서 Image editor를 통해 파일 저장 경로를 조작할 수 있는 불필요한 파라미터가 존재한다. sample.jpg?/../를 포함하는 파일 이름을 통해 이미지 저장 시 임의의 디렉터리에 쓸 수 있다. 
  	 * CVE-2019-9787 | 공격자는 CSRF[^1]를 통해 관리자 권한으로 서버의 PHP 파일을 임의로 변경할 수 있으며, 관리자 권한으로 일반 사용자보다 더 많은 HTML 태그를 삽입할 수 있고, 악의작인 JavaScript코드가 포함된 댓글을 작성할 수 있다.
  	 
 [^1]: CSRF(Cross Site Request Forgery) : 웹 어플리케이션 취약점 중 하나로 인터넷 사용자가 자신의 의지와는 무관하게 공격자가 의도한 행위(수정, 삭제, 등록)를 특정 웹사이트에 요청하게 만드는 공격   
 [^2]: SQL(Structured Query Language) : data base를 만들고 유지하는데 사용하는 프로그래밍 언어 중 하나. DB를 구축하고 조작하기 위해 사용하는 일종의 명령어. SQL을 이용하면 데이터를 정의, 조작, 제어할 수 있음

  	   	 
	* 공격 시나리오 (CVE-2019-8942/8943)
	
![cve1](https://user-images.githubusercontent.com/47182864/60860238-ab81ba80-a250-11e9-8757-11aeaca56c59.png)
 
  	1) 공격자는 공격대상이 취약한 버전의 WordPress를 사용하는지 확인함 
	2) 공격자는 악의적인 코드가 포함된 이미지를 해당 취약점을 이용하여 공격대상이 사용 중인 테마 폴더에 업로드함
	3) 공격자는 이미지에 삽입된 코드를 실행하기 위해 게시글 작성 시 템플릿 대신 업로드한 악성 미지를 사용하도록 요청을 변조함
	4) 공격자는 게시글에 포함된 악성 이미지를 통해 웹 서버 내 중요 정보를 탈취함
  
  
  * 공격 시나리오 (CVE-2019-9787)
  
![cve2](https://user-images.githubusercontent.com/47182864/60860242-ade41480-a250-11e9-8448-dc07dc812b62.png)

  	1) 공격자는 공격대상이 취약한 버전의 WordPress를 사용하는지 확인함
  	2) 공격자는 WordPress 관리자에게 악의적인 코드가 포함된 댓글을 작성하도록 하는 피싱 사이트에 접근하도록 유도함
  	3) 관리자는 WordPress 관리자로 로그인한 상태로 피싱 사이트에 접근함
  	4) 공격자는 CVE-2019-9787 취약점을 이용하여 관리자 권한으로 WordPressd에 악의적인 코드가 포함된 댓글을 작성함
  	5) 공격자는 댓글에 포함된 코드로 인해 변조된 플러그인 파일로 웹 서버 내 중요 정보를 탈취함
  	
---
### 2. 프로그램 결함
---
1. CWE
	* Common Weakness Enumeration의 약자로, 소프트웨어 개발 시 참고할 수 있는 보안 및 품질 관련 소프트웨어 취약점 목록
	* CWE는 다양한 소프트웨어 언어뿐만 아니라 아키텍처, 디자인 설계, 코딩 등 소프트웨어 개발 단계에서 발생 가능한 취약점을 제시한다.
	* 잘못된 연산자 사용, Buffer Overflow, Memory leak등과 같은 다양한 소프트웨어 오류의 취약점을 언어나 개발 환경 별로 분류하고, 각 항목 별로 번호를 매겨 관리하고 있다.
	
	> CWE-14 : Compiler Removal of Code to Clear Buffers 
	
	> 메모리에 저장된 중요한 정보에 대하여 사용 후 메모리에서 제거하는 작업을 수행하는 코드가 존재하지만 컴파일러 최적화로 인해 해당 부분의 코드가 삭제되어 중요 정보가 그대로 메모리에 잔존하는 것
	> > 1) 중요한 정보 또는 비밀 정보가 메모리에 저장된다.	
	> > 2) 중요 정보 사용 후, 해당 메모리에 담긴 내용을 덮어 쓰는 작업을 통해 중요 정보를 지워 버린다.
	> > 3) 이 때, 컴파일러 최적화 옵션을 적용하여 소스 코드 컴파일을 수행할 경우, 앞서 덮어 씌워진 메모리는 이후 코드 실행 시 더 이상 사용되지 않기 때문에 컴파일러는 중요 정보를 덮어쓰는 작업을 불필요하다 생각하여 해당 부분의 코드를 컴파일 과정에서 제거한다.	
	> > 4) 중요 정보를 제거하는 코드가 컴파일러 최적화 과정에서 삭제되었기 때문에 해당 중요 정보는 그대로 메모리에 저장되어 잔존하게 된다.
	
	* 방안 제시
		* 가능한 경우, 중요 데이터는 'volatile'로 선언된 메모리에 저장한다. 
			- 컴파일러는 'volatile' 키워드를 사용한 변수에 대하여 최적화를 수행하지 않아, 해당 변수에 대한 모든 연산이 실행된다.
		* 가능한 경우, 컴파일러를 설정하여 불필요한 코드가 삭제되는 것을 방어한다.
			- 최적화로 인한 오류를 방지하는 가장 기본적인 방법은, 최적화 옵션을 사용하지 않도록 컴파일러를 설정하는 것이다.
		* 가능한 경우, 소프트웨어 시스템에서 사용되는 중요 데이터를 암호화한다.
			- 중요한 정보를 그대로 메모리에 저장하지 않고 암호화된 정보로 저장할 경우, 1차적으로 정보 노출을 방어할 수 있다.
		
2. OWASP 
	* OWASP(The Open Web Application Security Project)는 오픈소스 웹 애플리케이션 보안 프로젝트이며, 주로 웹에 관한 정보노출, 악성 파일 및 스크립트, 보안 취약점 등을 연구한다.
	* Top 10 (웹 어플리케이션 취약점)
		- <https://ko.wikipedia.org/wiki/OWASP>
	* **인젝션**
		- 개요 | SQL[^2], OS, XXE, LDAP 인젝션 취약점은 신뢰할 수 없는 데이터가 명령어나 쿼리문의 일부분으로써, 인터프리터로 보내질 때 발생. 공격자의 악의적인 데이터는 예상치 못한 명령을 실행하거나 적절한 권한 없이 데이터에 접근하도록 인터프리터를 속일 수 있음
		- 취약점
			- 사용자 제공 데이터가 유효하지 않거나, 필터링 되어 지지 않거나, 애플리케이션에 의해 정제되지 않음 
			- 상황인식기반 필터링 없이 동적 쿼리나 매개 변수화 되지 않은 호출이 인터프리터에서 직접 사용됨
			- 악의적인 데이터가 객체 관계형 매핑(ORM) 검색매개변수 내에서 사용되어 추가로 민감한 정보를 추출함
			- 악의적인 데이터가 직접적으로 동적 쿼리안에 포함된 구조적 데이터와 악의적 데이터를 포함한 명령어, 일반명령어, SQL, 저장 프로시저에 사용되거나 연결됨
		

  	
---
### 3. 실제 사례
---
1. 유명한 해킹 사건
	* 현대캐피탈 해킹 사건
 
 > 2011년 4월, 금융대부업계 1위의 거대 기업 현대캐피탈이 총 175만 명에 달하는 고객의 정보를 해킹당했다
 
 * 사건의 개요
 
 > 이 사건은 허씨, 정씨, 신씨 등 국내와 해외에 거주하는 여러 범죄자들이 연계하여 일으킨 조직적 범죄였다. 이 사건에서 해킹을 담당한 것은 당시 필리핀에 거주하던 신씨다. 그는 _현대캐피탈 퇴직 직원이 사용하던 ID와 비밀번호를 통해 차량 정비 내역 조회서버와 광고메일 발송 서버에 침입했다._ 현대캐피탈은 리스용 차량 정비업체와 업무 제휴를 맺고 있어, 차량 정비 내역 조회 서버를 통해 개인정보를 조회할 수 있었는데, 이 서버에 해커가 침입한 것이었다. 게다가 이 서버는 개인정보를 조회하는 이력을 로그 파일로 남기고 있었는데, 로그 파일 자체는 암호화를 하지 않았다. _해커들은 화면을 복사하거나 해킹프로그램을 설치하고 로그 파일을 다운로드하는 방식 등으로 175만명의 고객정보를 해킹했다._ 당시 현대캐피탈 고객이 총 180만명 정도였으니 약 97%의 고객이 당한 것이다. [참고 - NAVER 지식백과]

	* 해킹 원인
	
	> 1. ID 및 비밀번호 관리 부실이다. 담당직원 퇴직 후 ID 및 비밀번호를 제때에 삭제하지 않았다. 그 결과 해커는 퇴직 직원이 사용하던 ID와 비밀번호를 사용하여 정비 내역 조회 서버에 총 7회 무단 접속하였다.  
	> 2. 보안 시스템 관리 미숙이다. 해킹 침입 방지 및 차단 시스템이 2월 15일부터 4월 6일까지의 기간 중해킹 사고와 동일한 IP에 의한 해킹 시도를 다수 탐지하였음에도 해킹 패턴 분석 및 해당 IP에 대한 접속 차단 등의 예방 조치를 실시하지 않았다.  
	> 3. 해킹 프로그램 업로드 차단 등 대응 조치 미흡이다. 현대캐피탈은 해킹 파일로 의심되는 확장자(.jsp)에 대한 해킹 프로그램 업로드 차단 필터링 기능이 미비했으며 파일 업로드 실행 권한 제거 등을 하지 않았다.  
	> 4. 고객 정보 암호화 미실시이다. 해킹 사고 발생 시 정보 유출을 최소화할 수 있도록 고객 정보 중 고객의 비밀번호 암호화가 수행되었어야 하나 실제로는 그렇지 않았다. 업무 관리자의 화면 조회 시 고객의 주민등록번호 뒷자리 숨김 표시 등이 실시되지 않았고, 고객의 비밀번호 암호화의 경우 주 고객 DB 서버 내에 보관 중인 고객 비밀번호는 암호화하고 있었으나, 고객 정보 조회 · 생성 · 변경 사실 등이 기록되는 로그파일에 남아 있는 고객 비밀번호는 암호화되지 않았다.
	 
     
2. 악성 코드

	<https://asec.ahnlab.com/949>

